DROP TABLE db_registro_empleados.token;
DROP TABLE db_registro_empleados.recargar_token;
DROP TABLE DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION;
DROP TABLE db_registro_empleados.usuario_rol;
DROP TABLE db_registro_empleados.AUTORIZACION;
DROP TABLE db_registro_empleados.roles;
DROP TABLE db_registro_empleados.CONTRATO;
DROP TABLE db_registro_empleados.personas;
DROP TABLE db_registro_empleados.usuarios;
DROP TABLE db_registro_empleados.TIPO_DOCUMENTO;
DROP TABLE db_registro_empleados.genero;

select *
from DB_REGISTRO_EMPLEADOS.roles;
select *
from DB_REGISTRO_EMPLEADOS.usuarios;
select *
from DB_REGISTRO_EMPLEADOS.token;
select *
from DB_REGISTRO_EMPLEADOS.USUARIO_ROL;
select *
from DB_REGISTRO_EMPLEADOS.personas;
select *
from db_registro_empleados.RECARGAR_TOKEN;
select *
from db_registro_empleados.tipo_documento;
select *
from db_registro_empleados.genero;

CREATE TABLE DB_REGISTRO_EMPLEADOS.ROLES
(
    ID_ROL      INT auto_increment NOT NULL,
    DESCRIPCION VARCHAR(60)        NOT NULL,
    CONSTRAINT ID_ROL_PK primary key (ID_ROL)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.AUTORIZACION
(
    ID_AUTORIZACION INT NOT NULL AUTO_INCREMENT,
    AUTORIZACION    VARCHAR(60),
#     ID_ROL          INT NOT NULL,
    CONSTRAINT AUTORIZACION_PK PRIMARY KEY (ID_AUTORIZACION)
#     CONSTRAINT ID_ROL FOREIGN KEY (ID_ROL) REFERENCES DB_REGISTRO_EMPLEADOS.ROLES (ID_ROL)
);

CREATE TABLE db_registro_empleados.ROL_AUTORIZACION
(
    ID_ROL     INT NOT NULL,
    ID_AUTORIZACION INT NOT NULL,
    CONSTRAINT ROL_AUTORIZACION_ROL_FK FOREIGN KEY (ID_ROL) REFERENCES db_registro_empleados.roles (ID_ROL),
    CONSTRAINT ROL_AUTORIZACION_AUTORIZACION_FK FOREIGN KEY (ID_AUTORIZACION) REFERENCES db_registro_empleados.AUTORIZACION (ID_AUTORIZACION)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.USUARIOS
(
    ID_USUARIO                         INT AUTO_INCREMENT NOT NULL,
    NOMBRES                            VARCHAR(60),
    APELLIDOS                          VARCHAR(60),
    USUARIO                            VARCHAR(60)        NOT NULL,
    CLAVE                              VARCHAR(255)       NOT NULL,
    CORREO_ELECTRONICO                 VARCHAR(255)       NOT NULL,
    FECHA_CREACION                     DATETIME,
    ESTADO                             VARCHAR(1) default 'N',
    SN_NO_BLOQUEADO                    VARCHAR(1) default 'S',
    FECHA_ULTIMO_INGRESO               DATETIME,
    FECHA_ULTIMO_INGRESO_VISUALIZACION DATETIME,
    IMAGEN_PERFIL_URL                  VARCHAR(200),
    CONSTRAINT ID_USUARIO_PK PRIMARY KEY (ID_USUARIO)
);

ALTER TABLE DB_REGISTRO_EMPLEADOS.USUARIOS ADD COLUMN CARGO VARCHAR(70);
ALTER TABLE DB_REGISTRO_EMPLEADOS.USUARIOS ADD COLUMN CELULAR VARCHAR(70);

CREATE TABLE db_registro_empleados.USUARIO_ROL
(
    ID_USUARIO INT NOT NULL,
    ID_ROL     INT NOT NULL,
    CONSTRAINT USUARIO_ROL_ROL_FK FOREIGN KEY (ID_ROL) REFERENCES db_registro_empleados.roles (ID_ROL),
    CONSTRAINT USUARIO_ROL_USUARIO_FK FOREIGN KEY (ID_USUARIO) REFERENCES db_registro_empleados.usuarios (ID_USUARIO)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.TOKEN
(
    ID_TOKEN         INT NOT NULL AUTO_INCREMENT,
    FECHA_EXPIRACION DATE,
    TOKEN            VARCHAR(255),
    ID_USUARIO       INT NOT NULL,
    CONSTRAINT NOTAS_TOKEN_PK PRIMARY KEY (ID_TOKEN),
    CONSTRAINT NOTAS_USUARIO_FK FOREIGN KEY (ID_USUARIO) REFERENCES DB_REGISTRO_EMPLEADOS.USUARIOS (ID_USUARIO)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.RECARGAR_TOKEN
(
    ID_RECARGAR_TOKEN INT NOT NULL AUTO_INCREMENT,
    TOKEN             VARCHAR(255),
    FECHA_CREACION    DATETIME,
    CONSTRAINT RECARGAR_TOKEN_PK PRIMARY KEY (ID_RECARGAR_TOKEN)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.TIPO_DOCUMENTO
(
    ID_TIPO_DOCUMENTO INT NOT NULL AUTO_INCREMENT,
    TIPO_DOCUMENTO    VARCHAR(6),
    DESCRIPCION       VARCHAR(40),
    CONSTRAINT TIPO_DOCUMENTO_PK PRIMARY KEY (ID_TIPO_DOCUMENTO)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.GENERO
(
    ID_GENERO   INT NOT NULL AUTO_INCREMENT,
    CDGENERO    VARCHAR(1),
    DESCRIPCION VARCHAR(40),
    CONSTRAINT GENERO_PK PRIMARY KEY (ID_GENERO)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.PERSONAS
(
    ID_PERSONA         INT         NOT NULL AUTO_INCREMENT,
    IDENTIFICACION     INT         NOT NULL,
    PRIMER_NOMBRE      VARCHAR(60) NOT NULL,
    SEGUNDO_NOMBRE     VARCHAR(60),
    PRIMER_APELLIDO    VARCHAR(60) NOT NULL,
    SEGUNDO_APELLIDO   VARCHAR(60),
    FECHA_NACIMIENTO   DATE,
    CORREO_ELECTRONICO VARCHAR(60),
    DIRECCION          VARCHAR(60),
    ID_TIPO_DOCUMENTO  INT         NOT NULL,
    ID_USUARIO         INT         NOT NULL,
    ID_GENERO          INT         NOT NULL,
    CONSTRAINT PERSONAS_PK PRIMARY KEY (ID_PERSONA),
    CONSTRAINT PERSONAS_TIPO_DOCUMENTO FOREIGN KEY (ID_TIPO_DOCUMENTO) REFERENCES DB_REGISTRO_EMPLEADOS.tipo_documento (id_tipo_documento),
    CONSTRAINT PERSONAS_USUARIO_FK FOREIGN KEY (ID_USUARIO) REFERENCES DB_REGISTRO_EMPLEADOS.USUARIOS (ID_USUARIO),
    CONSTRAINT PERSONAS_GENERO_FK FOREIGN KEY (ID_GENERO) REFERENCES DB_REGISTRO_EMPLEADOS.GENERO (ID_GENERO)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.TIPO_CONTRATO
(
    ID_TIPO_CONTRATO INT         NOT NULL AUTO_INCREMENT,
    TIPO_CONTRATO    VARCHAR(80) NOT NULL,
    CONSTRAINT TIPO_CONTRATO_PK PRIMARY KEY (ID_TIPO_CONTRATO)
);

CREATE TABLE DB_REGISTRO_EMPLEADOS.CONTRATO
(
    ID_CONTRATO        INT      NOT NULL AUTO_INCREMENT,
    FECHA_INGRESO      DATETIME NOT NULL,
    FECHA_SALIDA       DATETIME,
    DOCUMENTO_CONTRATO VARCHAR(500),
    ID_PERSONA         INT      NOT NULL,
    ID_TIPO_CONTRATO   INT      NOT NULL,
    CONSTRAINT CONTRATO_PK PRIMARY KEY (ID_CONTRATO),
    CONSTRAINT CONTRATO_PERSONA_FK FOREIGN KEY (ID_PERSONA) REFERENCES DB_REGISTRO_EMPLEADOS.PERSONAS (ID_PERSONA),
    CONSTRAINT CONTRATO_TIPO_CONTRATO FOREIGN KEY (ID_TIPO_CONTRATO) REFERENCES DB_REGISTRO_EMPLEADOS.TIPO_CONTRATO (ID_TIPO_CONTRATO)
);

-- ####################### INSERT ROLES
INSERT INTO DB_REGISTRO_EMPLEADOS.ROLES(ID_ROL, DESCRIPCION)
VALUES (1, 'ROLE_USER');
INSERT INTO DB_REGISTRO_EMPLEADOS.ROLES(ID_ROL, DESCRIPCION)
VALUES (2, 'ROLE_HR');
INSERT INTO DB_REGISTRO_EMPLEADOS.ROLES(ID_ROL, DESCRIPCION)
VALUES (3, 'ROLE_MANAGER');
INSERT INTO DB_REGISTRO_EMPLEADOS.ROLES(ID_ROL, DESCRIPCION)
VALUES (4, 'ROLE_ADMIN');
INSERT INTO DB_REGISTRO_EMPLEADOS.ROLES(ID_ROL, DESCRIPCION)
VALUES (5, 'ROLE_SUPER_ADMIN');

-- ####################### INSERT PERMISOS
INSERT INTO DB_REGISTRO_EMPLEADOS.AUTORIZACION(ID_AUTORIZACION, AUTORIZACION)
VALUES (1, 'user:consulta');

INSERT INTO DB_REGISTRO_EMPLEADOS.AUTORIZACION(ID_AUTORIZACION, AUTORIZACION)
VALUES (2, 'user:actualizar');

INSERT INTO DB_REGISTRO_EMPLEADOS.AUTORIZACION(ID_AUTORIZACION, AUTORIZACION)
VALUES (3, 'user:crear');

INSERT INTO DB_REGISTRO_EMPLEADOS.AUTORIZACION(ID_AUTORIZACION, AUTORIZACION)
VALUES (4, 'user:eliminar');


INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (1, 1);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (2, 1);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (2, 2);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (3, 1);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (3, 2);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (4, 1);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (4, 2);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (4, 3);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (5, 1);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (5, 2);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (5, 3);
INSERT INTO DB_REGISTRO_EMPLEADOS.ROL_AUTORIZACION(ID_ROL, ID_AUTORIZACION) VALUES (5, 4);


-- ####################### INSERT TIPO DOCUMENTOS
INSERT INTO DB_REGISTRO_EMPLEADOS.tipo_documento (id_tipo_documento, descripcion, tipo_documento)
VALUES (1, 'Cedula de Ciudadania', 'C.C');

INSERT INTO DB_REGISTRO_EMPLEADOS.tipo_documento (id_tipo_documento, descripcion, tipo_documento)
VALUES (2, 'Tarjeta de identidad', 'T.I');

INSERT INTO DB_REGISTRO_EMPLEADOS.tipo_documento (id_tipo_documento, descripcion, tipo_documento)
VALUES (3, 'Cedula de Extranjeria', 'C.E');

-- ####################### INSERT GENERO
INSERT INTO DB_REGISTRO_EMPLEADOS.GENERO (ID_GENERO, CDGENERO, DESCRIPCION)
VALUES (1, 'M', 'Mujer');

INSERT INTO DB_REGISTRO_EMPLEADOS.GENERO (ID_GENERO, CDGENERO, DESCRIPCION)
VALUES (2, 'H', 'Hombre');

INSERT INTO DB_REGISTRO_EMPLEADOS.GENERO (ID_GENERO, CDGENERO, DESCRIPCION)
VALUES (3, 'O', 'Otro');

INSERT INTO DB_REGISTRO_EMPLEADOS.personas (id_tipo_documento, identificacion, primer_apellido,
                                            primer_nombre, segundo_apellido, segundo_nombre, correo_electronico,
                                            direccion, fecha_nacimiento, ID_USUARIO, ID_GENERO)
VALUES (1, 1036680627, 'Juan', 'Felipe', 'Bedoya', 'Franco', 'devfelipefranco@gmail.com', 'Calle 9',
        STR_TO_DATE('30-08-1998', '%d-%m-%Y'), 6, 1);


INSERT INTO DB_REGISTRO_EMPLEADOS.TIPO_CONTRATO(ID_TIPO_CONTRATO, TIPO_CONTRATO)
VALUES (1, 'Termino Indefinido');

INSERT INTO DB_REGISTRO_EMPLEADOS.TIPO_CONTRATO(ID_TIPO_CONTRATO, TIPO_CONTRATO)
VALUES (2, 'Termino Fijo');

INSERT INTO DB_REGISTRO_EMPLEADOS.CONTRATO(ID_CONTRATO, FECHA_INGRESO, FECHA_SALIDA, DOCUMENTO_CONTRATO, ID_PERSONA,
                                           ID_TIPO_CONTRATO)
VALUES (1, STR_TO_DATE('30-08-1998', '%d-%m-%Y'), NULL, '', 80, 1);


SELECT * FROM DB_REGISTRO_EMPLEADOS.ROLES;
SELECT * FROM DB_REGISTRO_EMPLEADOS.autorizacion;
SELECT * FROM DB_REGISTRO_EMPLEADOS.rol_autorizacion;
SELECT * FROM DB_REGISTRO_EMPLEADOS.usuarios;
SELECT * FROM DB_REGISTRO_EMPLEADOS.usuario_rol;
SELECT * FROM DB_REGISTRO_EMPLEADOS.token;

delete from DB_REGISTRO_EMPLEADOS.USUARIOS;
delete from DB_REGISTRO_EMPLEADOS.TOKEN;
delete from DB_REGISTRO_EMPLEADOS.usuario_rol;
delete from DB_REGISTRO_EMPLEADOS.personas;